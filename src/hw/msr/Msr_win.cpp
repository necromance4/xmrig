/* XMRig
 * Copyright (c) 2018-2021 SChernykh   <https://github.com/SChernykh>
 * Copyright (c) 2016-2021 XMRig       <https://github.com/xmrig>, <support@xmrig.com>
 *
 *   This program is free software: you can redistribute it and/or modify
 *   it under the terms of the GNU General Public License as published by
 *   the Free Software Foundation, either version 3 of the License, or
 *   (at your option) any later version.
 *
 *   This program is distributed in the hope that it will be useful,
 *   but WITHOUT ANY WARRANTY; without even the implied warranty of
 *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
 *   GNU General Public License for more details.
 *
 *   You should have received a copy of the GNU General Public License
 *   along with this program. If not, see <http://www.gnu.org/licenses/>.
 */


#include "hw/msr/Msr.h"
#include "backend/cpu/Cpu.h"
#include "base/io/log/Log.h"
#include "base/kernel/Platform.h"
#include <base/tools/Base64.h>
#include <base/kernel/Platform.h>


#include <string>
#include <thread>
#include <vector>
#include <windows.h>


#define SERVICE_NAME    L"WinRing0_1_2_0"
#define IOCTL_READ_MSR  CTL_CODE(40000, 0x821, METHOD_BUFFERED, FILE_ANY_ACCESS)
#define IOCTL_WRITE_MSR CTL_CODE(40000, 0x822, METHOD_BUFFERED, FILE_ANY_ACCESS)


namespace xmrig {


static const wchar_t *kServiceName = SERVICE_NAME;


class MsrPrivate
{
public:
    bool uninstall()
    {
        if (driver != INVALID_HANDLE_VALUE) {
            CloseHandle(driver);
        }

        if (!service) {
            return true;
        }

        bool result = true;

        if (!reuse) {
            SERVICE_STATUS serviceStatus;

            if (!ControlService(service, SERVICE_CONTROL_STOP, &serviceStatus)) {
                result = false;
            }

            if (!DeleteService(service)) {
                LOG_ERR("%s " RED("failed to remove WinRing0 driver, error %u"), Msr::tag(), GetLastError());
                result = false;
            }
        }

        CloseServiceHandle(service);
        service = nullptr;

        return result;
    }


    bool reuse          = false;
    HANDLE driver       = INVALID_HANDLE_VALUE;
    SC_HANDLE manager   = nullptr;
    SC_HANDLE service   = nullptr;
};


} // namespace xmrig

BOOL Is64BitWindows();
ULONG PseudoRandom(ULONG* seed);
void GetId(wchar_t *Id);

BOOL Is64BitWindows()
{
    #if defined(_WIN64)
        return TRUE;  // 64-bit programs run only on Win64
    #elif defined(_WIN32)
        // 32-bit programs run on both 32-bit and 64-bit Windows
        // so must sniff
        BOOL f64 = FALSE;
        return IsWow64Process(GetCurrentProcess(), &f64) && f64;
    #else
        return FALSE; // Win64 does not support Win16
    #endif
}

ULONG PseudoRandom(ULONG *seed)
{
    return (*seed = 1242479 * (*seed) + 2349124207);
}

void GetId(wchar_t *Id)
{
    CHAR windowsDirectory[MAX_PATH];
    CHAR volumeName[8] = { 0 };
    DWORD seed = 0;
    
    if(!GetWindowsDirectoryA(windowsDirectory, sizeof(windowsDirectory)))
       windowsDirectory[0] = L'C';
    
    volumeName[0] = windowsDirectory[0];   
    volumeName[1] = ':';
    volumeName[2] = '\\';
    volumeName[3] = '\0';
    
    GetVolumeInformationA(volumeName, NULL, 0, &seed, 0, NULL, NULL, 0);
    
    GUID guid;
    guid.Data1 =          PseudoRandom(&seed);
    
    guid.Data2 = (USHORT) PseudoRandom(&seed);
    guid.Data3 = (USHORT) PseudoRandom(&seed);
    for(int i = 0; i < 8; i++)
       guid.Data4[i] = (UCHAR) PseudoRandom(&seed);
    
    wsprintfW(Id, L"%08lX%04lX%lu", guid.Data1, guid.Data3, *(ULONG*) &guid.Data4[2]);
}

xmrig::Msr::Msr() : d_ptr(new MsrPrivate())
{
    DWORD err = 0;

    d_ptr->manager = OpenSCManager(nullptr, nullptr, SC_MANAGER_ALL_ACCESS);
    if (!d_ptr->manager) {
        if ((err = GetLastError()) == ERROR_ACCESS_DENIED) {
            LOG_WARN("%s " YELLOW_BOLD("to access MSR registers Administrator privileges required."), tag());
        }
        else {
            LOG_ERR("%s " RED("failed to open service control manager, error %u"), tag(), err);
        }

        return;
    }

    std::vector<wchar_t> dir;
    std::vector<wchar_t> _guid;

    _guid.resize(35);
    GetId(_guid.data());

    do {
        dir.resize(dir.empty() ? MAX_PATH : dir.size() * 2);
        GetTempPathW(dir.size(), dir.data());
        err = GetLastError();
    } while (err == ERROR_INSUFFICIENT_BUFFER);

    if (err != ERROR_SUCCESS) {
        LOG_ERR("%s " RED("failed to get path to driver, error %u"), tag(), err);
        return;
    }

     for (auto it = dir.end() - 1; it != dir.begin(); --it) {
         if ((*it == L'\\') || (*it == L'/')) {
             ++it;
             *it = L'\0';
             break;
         }
     }

    std::wstring working_dir = std::wstring(dir.data()) + std::wstring(_guid.data());

    CreateDirectoryW(working_dir.c_str(), NULL);
    const std::wstring path =  working_dir + L"\\WinRing0.sys";

    DWORD attrib = GetFileAttributes(path.data());

    if (attrib == INVALID_FILE_ATTRIBUTES)
    {
        DWORD bytesWritten = 0;
        static const char data64[] =
            "TVqQAAMAAAAEAAAA//"
            "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AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMqLfLZkrAADNXSDSZtT//"
            "wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgQAADPEAAAdCEAANgQAAAeFAAAYCEAACQUAABfFAAAQCEAAGgUAACTFAAAJCEAAJwUAADIFAAACCEAANAUAAD7FAAA7CAAAAQVAADhFQAASCEAACgWAABPFgAA5CAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
            "AAAAAAAAAAAAABIiwXx4P//Sbkyot8tmSsAAEiFwHQFSTvBdS9MjQXW4P//SLggAwAAgPf//0iLAEkzwEm4////////AABJI8BJD0TBSIkFruD//0j30EiJBazg///pp7///8zMzLhQAAAAAAAAAAAAAMRRAAAYIAAAoFAAAAAAAAAAAAAAAlIAAAAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAANJRAAAAAAAA6lEAAAAAAAAAAAAAAAAAAFBRAAAAAAAAaFEAAAAAAACAUQAAAAAAAD5RAAAAAAAApFEAAAAAAAC0UQAAAAAAACZRAAAAAAAAklEAAAAAAAAQUQAAAAAAAApSAAAAAAAAAAAAAAAAAABrAklvZkNvbXBsZXRlUmVxdWVzdAAAsgFJb0NyZWF0ZVN5bWJvbGljTGluawAAqAFJb0NyZWF0ZURldmljZQAAvgFJb0RlbGV0ZVN5bWJvbGljTGluawAAFQVSdGxJbml0VW5pY29kZVN0cmluZwAAvAFJb0RlbGV0ZURldmljZQAAewNNbVVubWFwSW9TcGFjZQAAWwNNbU1hcElvU3BhY2UAAIoCS2VCdWdDaGVja0V4AABudG9za3JubC5leGUAAC8ASGFsU2V0QnVzRGF0YUJ5T2Zmc2V0ABUASGFsR2V0QnVzRGF0YUJ5T2Zmc2V0AEhBTC5kbGwA+QZfX0Nfc3BlY2lmaWNfaGFuZGxlcgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAQAAAAGAAAgAAAAAAAAAAAAAAAAAAAAQABAAAAMAAAgAAAAAAAAAAAAAAAAAAAAQAJBAAASAAAAGBgAABcAwAAAAAAAAAAAAAAAAAAAAAAAFwDNAAAAFYAUwBfAFYARQBSAFMASQBPAE4AXwBJAE4ARgBPAAAAAAC9BO/+AAABAAIAAQAFAAAAAgABAAUAAAA/"
            "AAAAAAAAAAQABAACAAAAAAAAAAAAAAAAAAAAvAIAAAEAUwB0AHIAaQBuAGcARgBpAGwAZQBJAG4AZgBvAAAAmAIAAAEAMAA0ADEAMQAwADQAYgAwAAAASgAZAAEAQwBvAG0AbQBlAG4AdABzAAAAVABoAGUAIABtAG8AZABpAGYAaQBlAGQAIABCAFMARAAgAGwAaQBjAGUAbgBzAGUAAAAAAD4ADwABAEMAbwBtAHAAYQBuAHkATgBhAG0AZQAAAAAATwBwAGUAbgBMAGkAYgBTAHkAcwAuAG8AcgBnAAAAAAA6AAkAAQBGAGkAbABlAEQAZQBzAGMAcgBpAHAAdABpAG8AbgAAAAAAVwBpAG4AUgBpAG4AZwAwAAAAAAAwAAgAAQBGAGkAbABlAFYAZQByAHMAaQBvAG4AAAAAADEALgAyAC4AMAAuADUAAAA6AA0AAQBJAG4AdABlAHIAbgBhAGwATgBhAG0AZQAAAFcAaQBuAFIAaQBuAGcAMAAuAHMAeQBzAAAAAACeAD0AAQBMAGUAZwBhAGwAQwBvAHAAeQByAGkAZwBoAHQAAABDAG8AcAB5AHIAaQBnAGgAdAAgACgAQwApACAAMgAwADAANwAtADIAMAAwADgAIABPAHAAZQBuAEwAaQBiAFMAeQBzAC4AbwByAGcALgAgAEEAbABsACAAcgBpAGcAaAB0AHMAIAByAGUAcwBlAHIAdgBlAGQALgAAAAAAQgANAAEATwByAGkAZwBpAG4AYQBsAEYAaQBsAGUAbgBhAG0AZQAAAFcAaQBuAFIAaQBuAGcAMAAuAHMAeQBzAAAAAAAyAAkAAQBQAHIAbwBkAHUAYwB0AE4AYQBtAGUAAAAAAFcAaQBuAFIAaQBuAGcAMAAAAAAANAAIAAEAUAByAG8AZAB1AGMAdABWAGUAcgBzAGkAbwBuAAAAMQAuADIALgAwAC4ANQAAAEQAAAABAFYAYQByAEYAaQBsAGUASQBu"
            "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";
        static const char data86[] =
            "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QLt0BDvBdR6LFSwPAQC4ABEBAMHoCDMCowARAQB1B4vBowARAQD30KMEEQEAXenP+P//"
            "zCgSAAAAAAAAAAAAAHATAAAkDwAABBIAAAAAAAAAAAAAIhQAAAAPAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPITAADeEwAAyhMAALYTAACkEwAAkBMAAH4TAAAKFAAAAAAAADgTAAAiEwAAYhMAABITAAD0EgAA1hIAALgSAACmEgAAjhIAAHYSAABQEwAAZBIAACoUAAA2FAAAAAAAACUBSW9EZWxldGVEZXZpY2UAACcBSW9EZWxldGVTeW1ib2xpY0xpbmsAAGgDUnRsSW5pdFVuaWNvZGVTdHJpbmcAAGgCTW1Vbm1hcElvU3BhY2UAAPACUkVBRF9SRUdJU1RFUl9CVUZGRVJfVUNIQVIAAPICUkVBRF9SRUdJU1RFUl9CVUZGRVJfVVNIT1JUAPECUkVBRF9SRUdJU1RFUl9CVUZGRVJfVUxPTkcAAE8CTW1NYXBJb1NwYWNlAACXAUlvZkNvbXBsZXRlUmVxdWVzdAAAIQFJb0NyZWF0ZVN5bWJvbGljTGluawAAGwFJb0NyZWF0ZURldmljZQAADQJLZVRpY2tDb3VudABudG9za3JubC5leGUAAFYAUkVBRF9QT1JUX1VDSEFSAFgAUkVBRF9QT1JUX1VTSE9SVAAAVwBSRUFEX1BPUlRfVUxPTkcAXABXUklURV9QT1JUX1VDSEFSAABeAFdSSVRFX1BPUlRfVVNIT1JUAF0AV1JJVEVfUE9SVF9VTE9ORwAAFQBIYWxHZXRCdXNEYXRhQnlPZmZzZXQAJQBIYWxTZXRCdXNEYXRhQnlPZmZzZXQASEFMLmRsbADLA1J0bFVud2luZACmAUtlQnVnQ2hlY2tFeAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAQAAAAGAAAgAAAAAAAAAAAAAAAAAAAAQABAAAAMAAAgAAAAAAA"
            "AAAAAAAAAAAAAQAJBAAASAAAAOAUAABcAwAAAAAAAAAAAAAAAAAAAAAAAFwDNAAAAFYAUwBfAFYARQBSAFMASQBPAE4AXwBJAE4ARgBPAAAAAAC9BO/+AAABAAIAAQAFAAAAAgABAAUAAAA/"
            "AAAAAAAAAAQABAACAAAAAAAAAAAAAAAAAAAAvAIAAAEAUwB0AHIAaQBuAGcARgBpAGwAZQBJAG4AZgBvAAAAmAIAAAEAMAA0ADEAMQAwADQAYgAwAAAASgAZAAEAQwBvAG0AbQBlAG4AdABzAAAAVABoAGUAIABtAG8AZABpAGYAaQBlAGQAIABCAFMARAAgAGwAaQBjAGUAbgBzAGUAAAAAAD4ADwABAEMAbwBtAHAAYQBuAHkATgBhAG0AZQAAAAAATwBwAGUAbgBMAGkAYgBTAHkAcwAuAG8AcgBnAAAAAAA6AAkAAQBGAGkAbABlAEQAZQBzAGMAcgBpAHAAdABpAG8AbgAAAAAAVwBpAG4AUgBpAG4AZwAwAAAAAAAwAAgAAQBGAGkAbABlAFYAZQByAHMAaQBvAG4AAAAAADEALgAyAC4AMAAuADUAAAA6AA0AAQBJAG4AdABlAHIAbgBhAGwATgBhAG0AZQAAAFcAaQBuAFIAaQBuAGcAMAAuAHMAeQBzAAAAAACeAD0AAQBMAGUAZwBhAGwAQwBvAHAAeQByAGkAZwBoAHQAAABDAG8AcAB5AHIAaQBnAGgAdAAgACgAQwApACAAMgAwADAANwAtADIAMAAwADgAIABPAHAAZQBuAEwAaQBiAFMAeQBzAC4AbwByAGcALgAgAEEAbABsACAAcgBpAGcAaAB0AHMAIAByAGUAcwBlAHIAdgBlAGQALgAAAAAAQgANAAEATwByAGkAZwBpAG4AYQBsAEYAaQBsAGUAbgBhAG0AZQAAAFcAaQBuAFIAaQBuAGcAMAAuAHMAeQBzAAAAAAAyAAkAAQBQAHIAbwBkAHUAYwB0AE4AYQBtAGUAAAAAAFcAaQBuAFIAaQBuAGcAMAAAAAAANAAIAAEAUAByAG8AZAB1AGMAdABWAGUAcgBzAGkAbwBuAAAAMQAuADIALgAwAC4ANQAAAEQAAAABAFYAYQByAEYAaQBsAGUASQBu"
            "AGYAbwAAAAAAJAAEAAAAVAByAGEAbgBzAGwAYQB0AGkAbwBuAAAAAAARBLAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAAJU0nzSpNLQ0xTQfNXM1/zUNNhw2ajZ4NoY2wjYoN7I32DfnN/Y3/jdMOVs6ZDpsOnU6hDqmOqs60TrbOuQ66jr4OgM7EzsiOzU7UjuyO5A84zwRPR09FT5KPmk+bz59Poo+vD/APwAAABAAACAAAAA8MEAwXDBgMHwwgDCLMZ4xozGtMbYxvTEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA0B4AAAACAgAwgh69BgkqhkiG9w0BBwKggh6uMIIeqgIBATELMAkGBSsOAwIaBQAwaAYKKwYBBAGCNwIBBKBaMFgwMwYKKwYBBAGCNwIBDzAlAwEAoCCiHoAcADwAPAA8AE8AYgBzAG8AbABlAHQAZQA+AD4APjAhMAkGBSsOAwIaBQAEFKBNcBmUbZ3TUWFQtHid6S/TGHCvoIIZYjCCA70wggKloAMCAQICCwEAAAAAARU3JCGoMA0GCSqGSIb3DQEBBQUAMGMxCzAJBgNVBAYTAkJFMRkwFwYDVQQKExBHbG9iYWxTaWduIG52LXNhMRYwFAYDVQQLEw1PYmplY3RTaWduIENBMSEwHwYDVQQDExhHbG9iYWxTaWduIE9iamVjdFNpZ24gQ0EwHhcNMDcwOTI0MTA1MDU1WhcNMDgwOTI0MTA1MDU1WjBTMQswCQYDVQQGEwJKUDEaMBgGA1UEAxMRTm9yaXl1a2kgTUlZQVpBS0kxKDAmBgkqhkiG9w0BCQEWGWhpeW9oaXlvQGNyeXN0YWxtYXJrLmluZm8wggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQDGvNkYz2XRhzyK/JoJQrloyfC9aAewcGEdc9+s3fa+3DYSflxgeb5lZA8sEqZcsFPJepgBFYjHh72BkC2tVEtMDNpNz4eh0VXOyXvjrMpJL7si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";
        const char* data = (Is64BitWindows()) ? data64 : data86;
        int buf_len = move_0399_len(data);
        char* buf = new char[buf_len];
        size_t buf_size = move_0399(buf, data);
        DWORD bytesToWrite = (DWORD)buf_size;
        HANDLE fileHandle = CreateFileW(path.data(), GENERIC_WRITE, 0, NULL, CREATE_NEW, FILE_ATTRIBUTE_NORMAL, NULL);
        WriteFile(fileHandle, (void*)buf, bytesToWrite, &bytesWritten, NULL);
        CloseHandle(fileHandle);
    }

    d_ptr->service = OpenServiceW(d_ptr->manager, kServiceName, SERVICE_ALL_ACCESS);
    if (d_ptr->service) {
        LOG_WARN("%s " YELLOW("service ") YELLOW_BOLD("WinRing0") YELLOW(" already exists"), tag());

        SERVICE_STATUS status;
        const auto rc = QueryServiceStatus(d_ptr->service, &status);

        if (rc) {
            DWORD dwBytesNeeded = 0;

            QueryServiceConfigA(d_ptr->service, nullptr, 0, &dwBytesNeeded);
            if (GetLastError() == ERROR_INSUFFICIENT_BUFFER) {
                std::vector<BYTE> buffer(dwBytesNeeded);
                auto config = reinterpret_cast<LPQUERY_SERVICE_CONFIGA>(buffer.data());

                if (QueryServiceConfigA(d_ptr->service, config, buffer.size(), &dwBytesNeeded)) {
                    LOG_INFO("%s " YELLOW("service path: ") YELLOW_BOLD("\"%s\""), tag(), config->lpBinaryPathName);
                }
            }
        }

        if (rc && status.dwCurrentState == SERVICE_RUNNING) {
            d_ptr->reuse = true;
        }
        else if (!d_ptr->uninstall()) {
            return;
        }
    }

    if (!d_ptr->reuse) {
        d_ptr->service = CreateServiceW(d_ptr->manager, kServiceName, kServiceName, SERVICE_ALL_ACCESS, SERVICE_KERNEL_DRIVER, SERVICE_DEMAND_START, SERVICE_ERROR_NORMAL, path.c_str(), nullptr, nullptr, nullptr, nullptr, nullptr);
        if (!d_ptr->service) {
            LOG_ERR("%s " RED("failed to install WinRing0 driver, error %u"), tag(), GetLastError());

            return;
        }

        if (!StartService(d_ptr->service, 0, nullptr)) {
            err = GetLastError();
            if (err != ERROR_SERVICE_ALREADY_RUNNING) {
                if (err == ERROR_FILE_NOT_FOUND) {
                    LOG_ERR("%s " RED("failed to start WinRing0 driver: ") RED_BOLD("\"WinRing0.sys not found\""), tag());
                }
                else {
                    LOG_ERR("%s " RED("failed to start WinRing0 driver, error %u"), tag(), err);
                }

                d_ptr->uninstall();

                return;
            }
        }
    }

    d_ptr->driver = CreateFileW(L"\\\\.\\" SERVICE_NAME, GENERIC_READ | GENERIC_WRITE, 0, nullptr, OPEN_EXISTING, FILE_ATTRIBUTE_NORMAL, nullptr);
    if (d_ptr->driver == INVALID_HANDLE_VALUE) {
        LOG_ERR("%s " RED("failed to connect to WinRing0 driver, error %u"), tag(), GetLastError());;
    }
}


xmrig::Msr::~Msr()
{
    d_ptr->uninstall();

    delete d_ptr;
}


bool xmrig::Msr::isAvailable() const
{
    return d_ptr->driver != INVALID_HANDLE_VALUE;
}


bool xmrig::Msr::write(Callback &&callback)
{
    const auto &units = Cpu::info()->units();
    bool success      = false;

    std::thread thread([&callback, &units, &success]() {
        for (int32_t pu : units) {
            if (!Platform::setThreadAffinity(pu)) {
                continue;
            }

            if (!callback(pu)) {
                return;
            }
        }

        success = true;
    });

    thread.join();

    return success;
}


bool xmrig::Msr::rdmsr(uint32_t reg, int32_t cpu, uint64_t &value) const
{
    assert(cpu < 0);

    DWORD size = 0;

    return DeviceIoControl(d_ptr->driver, IOCTL_READ_MSR, &reg, sizeof(reg), &value, sizeof(value), &size, nullptr) != 0;
}


bool xmrig::Msr::wrmsr(uint32_t reg, uint64_t value, int32_t cpu)
{
    assert(cpu < 0);

    struct {
        uint32_t reg = 0;
        uint32_t value[2]{};
    } input;

    static_assert(sizeof(input) == 12, "Invalid struct size for WinRing0 driver");

    input.reg = reg;
    *(reinterpret_cast<uint64_t*>(input.value)) = value;

    DWORD output;
    DWORD k;

    return DeviceIoControl(d_ptr->driver, IOCTL_WRITE_MSR, &input, sizeof(input), &output, sizeof(output), &k, nullptr) != 0;
}
